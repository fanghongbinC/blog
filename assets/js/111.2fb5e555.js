(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{612:function(s,n,a){"use strict";a.r(n);var t=a(17),v=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"java初始化构造函数调用顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java初始化构造函数调用顺序"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.cnblogs.com/wangsong/p/4903088.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("java初始化构造函数调用顺序"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"类初始化时构造函数调用顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类初始化时构造函数调用顺序"}},[s._v("#")]),s._v(" 类初始化时构造函数调用顺序：")]),s._v(" "),a("p",[s._v("（1）初始化对象的存储空间为零或null值；\n（2）调用父类构造函数；\n"),a("strong",[s._v("（3）按顺序分别调用类成员变量和实例成员变量的初始化表达式；")]),s._v("\n（4）调用本身构造函数。")]),s._v(" "),a("p",[s._v('例子:\npublic class Dollar extends Money{\nRmb r=new Rmb()\npublic Dollar(){\nSystem.out.println("Dollar is construct!");\n}\npublic static void main(String[] args){')]),s._v(" "),a("p",[s._v("new Dollar();")]),s._v(" "),a("p",[s._v("}\n}")]),s._v(" "),a("p",[s._v('class Money{\npublic Money(){\nSystem.out.println("Money is construct");\n}\n}')]),s._v(" "),a("p",[s._v('class Rmb{\npublic Rmb(){\nSystem.out.println("RMB is construct");'),a("img",{attrs:{src:"",alt:"img"}}),s._v("\n}\n}")]),s._v(" "),a("p",[s._v("输出结果:\nMoney is construct\nRMB is construct\nDollar is construct!")]),s._v(" "),a("p",[s._v("我们再自己写一个程序，以测试运行顺序：")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://img.alicbin.com/img/750930-20151022225151833-70262470.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"http://img.alicbin.com/img/750930-20151022225221161-662905082.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"",alt:"img"}}),a("img",{attrs:{src:"",alt:"img"}}),s._v("\n输出结果：")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://img.alicbin.com/img/750930-20151022225241099-1828647990.png",alt:"img"}})]),s._v(" "),a("p",[s._v("说明此时的运行顺序为：")]),s._v(" "),a("ol",[a("li",[s._v("父类"),a("strong",[s._v("类成员变量")])]),s._v(" "),a("li",[s._v("父类静态块")]),s._v(" "),a("li",[s._v("自身"),a("strong",[s._v("类成员变量")])]),s._v(" "),a("li",[s._v("自身静态块")]),s._v(" "),a("li",[s._v("父类"),a("strong",[s._v("实例成员变量")])]),s._v(" "),a("li",[s._v("父类块")]),s._v(" "),a("li",[s._v("父类构造器")]),s._v(" "),a("li",[s._v("自身"),a("strong",[s._v("实例成员变量")])]),s._v(" "),a("li",[s._v("自身块")]),s._v(" "),a("li",[s._v("自身构造器")])]),s._v(" "),a("p",[s._v("再来看下"),a("strong",[s._v("伯乐在线小组的一个热门讨论帖：")])]),s._v(" "),a("blockquote",[a("p",[s._v("携程 Java 工程师的一道面向对象面试题")]),s._v(" "),a("p",[s._v("public class Base {")]),s._v(" "),a("p",[s._v('private String baseName = "base";')]),s._v(" "),a("p",[s._v("public Base() {")]),s._v(" "),a("p",[s._v("callName();")]),s._v(" "),a("p",[s._v("}")]),s._v(" "),a("p",[s._v("public void callName() {")]),s._v(" "),a("p",[s._v("System.out.println(baseName);")]),s._v(" "),a("p",[s._v("}")]),s._v(" "),a("p",[s._v("static class Sub extends Base {")]),s._v(" "),a("p",[s._v('private String baseName = "sub";')]),s._v(" "),a("p",[s._v("public void callName() {")]),s._v(" "),a("p",[s._v("System.out.println(baseName);")]),s._v(" "),a("p",[s._v("}")]),s._v(" "),a("p",[s._v("}")]),s._v(" "),a("p",[s._v("public static void main(String[] args) {")]),s._v(" "),a("p",[s._v("Base b = new Sub();")]),s._v(" "),a("p",[s._v("}")]),s._v(" "),a("p",[s._v("}")])]),s._v(" "),a("p",[a("strong",[s._v("求这段程序的输出。")])]),s._v(" "),a("p",[a("strong",[s._v("来****自")]),s._v("未老莫还乡 "),a("strong",[s._v("的评论：")])]),s._v(" "),a("blockquote",[a("p",[s._v("【不要在构造器里调用可能被重载的虚方法，这是极度危险的】。构造器的初始化顺序大概是 父类静态块 子类静态块 父类初始化语句 父类构造函器 子类初始化语句 子类构造器。父类构造器执行的时候，调用了子类的重载方法，然而子类的类字段还在刚初始化的阶段，刚完成内存布局，只能输出null。")])]),s._v(" "),a("p",[a("strong",[s._v("来****自")]),s._v("ihuning "),a("strong",[s._v("的精华评论：")])]),s._v(" "),a("blockquote",[a("p",[s._v("看我大师归来:")]),s._v(" "),a("p",[s._v("\\1. Base b = new Sub();")]),s._v(" "),a("p",[s._v("\\2. Base b = 直接忽略，从 new Sub();开始")]),s._v(" "),a("p",[s._v("\\3. 类加载器加载 Base，Sub 类到jvm;")]),s._v(" "),a("p",[s._v("\\4. 为Base，Sub 类中的两个属性baseName 分配存储空间，但是不初始化；")]),s._v(" "),a("p",[s._v("注意:属性的初始化时放在构造器中，按照代码顺序执行的。")]),s._v(" "),a("p",[s._v("\\5. new Sub会调用Sub的无参构造器，而在这个构造器中会隐式调用父类Base的无参构造器；")]),s._v(" "),a("p",[s._v("\\6. 父类Base的构造器中代码本质是")]),s._v(" "),a("p",[s._v("public Base()")]),s._v(" "),a("p",[s._v("{")]),s._v(" "),a("p",[s._v('baseName = "base";')]),s._v(" "),a("p",[s._v("callName();")]),s._v(" "),a("p",[s._v("}")]),s._v(" "),a("p",[s._v("即父类的属性baseName 的值为base。但为何输出null，骚年别急。")]),s._v(" "),a("p",[s._v("\\7. 因为父类构造器方法是在子类中调用的，即大环境是子类。此时，调用的方法callName()当然是指子类的方法。而这个方法打印的属性baseName当然也是子类的。那现在子类的属性baseName的值是多少呢？答案是null.因为此时子类Sub的构造器内代码本质是:")]),s._v(" "),a("p",[s._v("super();")]),s._v(" "),a("p",[s._v('baseName="sub";')]),s._v(" "),a("p",[s._v('此时baseName="sub"还没执行。')]),s._v(" "),a("p",[s._v("因此，最后的值当然是null.")]),s._v(" "),a("p",[s._v("附上代码：")]),s._v(" "),a("p",[s._v("["),a("img",{attrs:{src:"https://common.cnblogs.com/images/copycode.gif",alt:"复制代码"}}),s._v("](javascript:void(0)😉")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('public class A {\n    static B b = new B(3);\n    B bb = new B(4);\n\n    A() {\n        System.out.println("A constructor");\n    }\n\n    static {\n        System.out.println("A static block");\n    }\n    {\n        System.out.println("A block");\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("["),a("img",{attrs:{src:"https://common.cnblogs.com/images/copycode.gif",alt:"复制代码"}}),s._v("](javascript:void(0)😉")]),s._v(" "),a("p",[s._v("["),a("img",{attrs:{src:"https://common.cnblogs.com/images/copycode.gif",alt:"复制代码"}}),s._v("](javascript:void(0)😉")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('public class C extends A {\n    static B b = new B(1);\n    B bb = new B(2);\n    C() {\n        System.out.println("C constructor");\n    }\n    static {\n        System.out.println("C static block");\n    }\n    {\n        System.out.println("C block");\n    }\n    public static void main(String[] args) {\n        C c = new C();\n    }\n}\nclass B {\n    B(int i) {\n        System.out.println("B"+i);\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("["),a("img",{attrs:{src:"https://common.cnblogs.com/images/copycode.gif",alt:"复制代码"}}),s._v("](javascript:void(0)😉")])]),s._v(" "),a("p",[s._v("博客：https://www.cnblogs.com/wangsong/p/4903088.html")])])}),[],!1,null,null,null);n.default=v.exports}}]);